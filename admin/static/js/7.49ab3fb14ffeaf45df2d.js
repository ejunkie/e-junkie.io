webpackJsonp([7],{g2dq:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"Templates",data:()=>({Templates:null,Template:null,showTemplates:!0,editor:!0,preview:!1,savingTemplate:!1,codeMirror:null,selectedTheme:"monokai",selectedFontSize:14,wordWrap:!1,availableThemes:["default","3024-day","3024-night","abcdef","ambiance","base16-dark","base16-light","bespin","blackboard","cobalt","colorforth","darcula","dracula","duotone-dark","duotone-light","eclipse","elegant","erlang-dark","gruvbox-dark","hopscotch","icecoder","idea","isotope","lesser-dark","liquibyte","lucario","material","mbo","mdn-like","midnight","monokai","neat","neo","night","oceanic-next","panda-syntax","paraiso-dark","paraiso-light","pastel-on-dark","railscasts","rubyblue","seti","shadowfox","solarized dark","solarized light","the-matrix","tomorrow-night-bright","tomorrow-night-eighties","ttcn","twilight","vibrant-ink","xq-dark","xq-light","yeti","zenburn"],loader:null,editorHeight:10,availableEditorHeight:[10,15,20,25,30,35,40,45,50]}),watch:{Template:function(e){},editor:function(e){this.editor||this.showTemplates||this.preview||(this.editor=!0),this.injectCodeMirror()},showTemplates:function(e){this.editor||this.showTemplates||this.preview||(this.editor=!0)},selectedTheme:function(e){this.myCodeMirror&&this.myCodeMirror.setOption("theme",e),this.storePrefs()},wordWrap:function(e){this.myCodeMirror&&this.myCodeMirror.setOption("lineWrapping",e),this.storePrefs()},editorHeight:function(e){e=parseInt(e),this.myCodeMirror&&this.myCodeMirror.setSize(null,e*this.myCodeMirror.defaultTextHeight()),this.storePrefs()}},mounted:function(){if("undefined"!=typeof Storage){var e=JSON.parse(localStorage.getItem("TemplateEditorPrefs"));e&&(this.selectedTheme=e.selectedTheme,this.wordWrap=e.wordWrap,this.editorHeight=e.editorHeight,this.selectedFontSize=e.selectedFontSize)}this.$notify.info({title:"Ctrl+S",message:"Save changes by pressing Ctrl + S"});var t=this;this.loader=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.converter=new showdown.Converter,window.addEventListener("keydown",t.keyboardEvent,!1),this.axios.post(window.Config.API.endpoint+"templates",{}).then(e=>{t.Templates=e.data,setTimeout(()=>{t.loader&&t.loader.close()},500)}).catch(e=>{console.log(e)})},methods:{storePrefs:function(){var e={selectedTheme:this.selectedTheme,wordWrap:this.wordWrap,editorHeight:this.editorHeight,selectedFontSize:this.selectedFontSize};"undefined"!=typeof Storage&&localStorage.setItem("TemplateEditorPrefs",JSON.stringify(e))},keyboardEvent:function(e){if("s"==e.key&&e.ctrlKey){if(e.preventDefault(),this.savingTemplate)return!1;this.saveTemplate()}},getTemplate:function(e){if("new"==e)return this.Template={key:"new",template:""},setTimeout(this.injectCodeMirror,200),!1;var t=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),i=this;this.axios.post(window.Config.API.endpoint+"template",{key:e}).then(e=>{i.Template=e.data,i.injectCodeMirror(),setTimeout(()=>{t.close()},100)}).catch(e=>{setTimeout(()=>{t.close()},100)})},saveTemplate:function(e){if("new"==(i=this).Template.key)return i.$message({showClose:!0,message:"Not a valid template name",type:"warning"}),!1;if(!this.myCodeMirror)return!1;this.savingTemplate=!0;var t=this.$loading({lock:!0,text:"Saving",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),i=this;this.axios.post(window.Config.API.endpoint+"template/save",{key:i.Template.key,template:i.myCodeMirror.getValue()}).then(e=>{i.Template=e.data.Template,i.Templates=e.data.Templates,i.$message({showClose:!0,message:"Template saved successfully",type:"success"}),setTimeout(()=>{t.close()},100),this.savingTemplate=!1}).catch(e=>{setTimeout(()=>{t.close()},100),this.savingTemplate=!1})},deleteTemplate:function(e){this.savingTemplate=!0;var t=this.$loading({lock:!0,text:"Deleting",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),i=this;this.axios.post(window.Config.API.endpoint+"template/delete",{key:i.Template.key}).then(e=>{i.Templates=e.data,i.Template=null,i.$message({showClose:!0,message:"Template deleted !",type:"danger"}),setTimeout(()=>{t.close()},100),this.savingTemplate=!1}).catch(e=>{setTimeout(()=>{t.close()},100),this.savingTemplate=!1})},injectCodeMirror:function(){var e=this;if(this.Template.template);else if("new"!=this.Template.key)return e.$message({showClose:!0,message:"Can't load template!",type:"warning"}),this.Template=null,!1;setTimeout(function(){CodeMirror.keyMap.sublime;var t=document.getElementById("templateEditorTextarea");if(document.getElementById("templateEditorTextarea").parentNode.children[1]||(e.myCodeMirror=null),e.myCodeMirror)return e.myCodeMirror.setValue(e.Template.template),!1;e.myCodeMirror=CodeMirror(function(e){var i=t.cloneNode(!0);t.parentNode.appendChild(i),t.parentNode.replaceChild(e,i)},{value:e.Template.template,lineNumbers:!0,mode:"text/html",keyMap:"sublime",autoCloseBrackets:!0,matchBrackets:!0,showCursorWhenSelecting:!0,tabSize:2,theme:"monokai",matchTags:{bothTags:!0},extraKeys:{"Ctrl-J":"toMatchingTag"}}),e.myCodeMirror.setSize(null,e.editorHeight*e.myCodeMirror.defaultTextHeight()),e.myCodeMirror.setOption("theme",e.selectedTheme),e.myCodeMirror.setOption("lineWrapping",e.wordWrap)},1e3)}},destroyed:function(){window.removeEventListener("keydown",this.keyboardEvent)}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"templates"}},[i("div",{staticClass:"columns is-multiline"},[i("div",{class:{column:!0,"is-2":e.showTemplates,"is-1":!e.showTemplates}},[i("div",{staticClass:"box details"},[i("div",{staticClass:"box-title"},[i("i",{staticClass:"icon ion-md-brush"}),e._v(" "),i("i",{class:{active:e.showTemplates,"icon is-pulled-right":!0,"ion-md-arrow-dropright-circle":!e.showTemplates,"ion-md-arrow-dropleft-circle":e.showTemplates},on:{click:function(t){e.showTemplates=!e.showTemplates}}}),e._v("\n\t\t  \t\t\tTemplates\n\t\t  \t\t")]),e._v(" "),e.Templates&&e.showTemplates?i("div",{staticClass:"box-content templatesList"},[i("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){return e.getTemplate("new")}}},[e._v("Add New Template")]),e._v(" "),e._l(e.Templates,function(t,a){return i("el-button",{attrs:{type:"danger",plain:""},on:{click:function(i){return e.getTemplate(t)}}},[e._v(e._s(t))])})],2):e._e()])]),e._v(" "),i("div",{class:{"column editor":!0,"is-10":e.showTemplates,"is-11":!e.showTemplates}},[i("div",{staticClass:"box details"},[i("div",{staticClass:"box-title"},[i("i",{staticClass:"icon ion-md-create"}),e._v(" "),e._v("\n\t\t  \t\t\tEditor \n\t\t  \t\t\t"),e.Template?i("el-input",{attrs:{placeholder:"Template Name",size:"mini",clearable:""},model:{value:e.Template.key,callback:function(t){e.$set(e.Template,"key",t)},expression:"Template.key"}}):e._e(),e._v(" "),e.Template?i("el-button",{attrs:{size:"small",icon:"el-icon-circle-check",type:"success",plain:"",loading:e.savingTemplate},on:{click:function(t){return e.saveTemplate()}}},[e._v("Save")]):e._e(),e._v(" "),e.Template?i("el-button",{attrs:{size:"small",icon:"el-icon-delete",type:"warning",plain:"",loading:e.savingTemplate},on:{click:function(t){return e.deleteTemplate()}}},[e._v("Delete")]):e._e(),e._v(" "),e.Template?i("el-button",{attrs:{size:"small",icon:"el-icon-circle-close",type:"danger",plain:""},on:{click:function(t){e.Template=null}}},[e._v("Discard")]):e._e()],1),e._v(" "),e.editor&&e.Template?i("div",{staticClass:"box-content"},[i("div",{staticClass:"columns is-multiline has-text-centered",staticStyle:{"margin-bottom":"0px"}},[i("div",{staticClass:"column is-3"},[i("span",{staticClass:"title"},[e._v("Editor Height")]),e._v(" "),i("el-select",{attrs:{placeholder:"Editor Height(lines)",size:"mini"},model:{value:e.editorHeight,callback:function(t){e.editorHeight=t},expression:"editorHeight"}},e._l(e.availableEditorHeight,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("div",{staticClass:"column is-3"},[i("span",{staticClass:"title"},[e._v("Wordwrap")]),e._v(" "),i("el-switch",{staticStyle:{display:"inline-block","margin-right":"10px","margin-top":"-3px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"","inactive-text":""},model:{value:e.wordWrap,callback:function(t){e.wordWrap=t},expression:"wordWrap"}})],1),e._v(" "),i("div",{staticClass:"column is-3"},[i("span",{staticClass:"title"},[e._v("Font Size")]),e._v(" "),i("el-input-number",{attrs:{min:10,max:20,step:2,size:"mini"},model:{value:e.selectedFontSize,callback:function(t){e.selectedFontSize=t},expression:"selectedFontSize"}})],1),e._v(" "),i("div",{staticClass:"column is-3"},[i("span",{staticClass:"title"},[e._v("Theme")]),e._v(" "),i("el-select",{attrs:{placeholder:"Select Theme",size:"mini"},model:{value:e.selectedTheme,callback:function(t){e.selectedTheme=t},expression:"selectedTheme"}},e._l(e.availableThemes,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]),e._v(" "),i("div",{style:{fontSize:e.selectedFontSize+"px"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.Template.template,expression:"Template.template"}],attrs:{id:"templateEditorTextarea"},domProps:{value:e.Template.template},on:{input:function(t){t.target.composing||e.$set(e.Template,"template",t.target.value)}}})])]):e._e()])])])])},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(e){i("i9B2")},"data-v-0d2885f7",null);t.default=o.exports},i9B2:function(e,t){}});
//# sourceMappingURL=7.49ab3fb14ffeaf45df2d.js.map